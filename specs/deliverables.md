# 開発サマリー

## 実装済み機能

### タイトル画面（TitleScene）
- 3つのメニューボタン
  - 新規ゲーム: メインゲーム画面へ遷移
  - 続きから: 最新セーブをロード（セーブがない場合は非活性）
  - 設定: モーダル表示
- セーブデータの有無による「続きから」ボタンの状態制御

### メインゲーム画面（MainGameScene）
- タイトル画面の「新規ゲーム」から遷移
- 月次ターン進行システム
  - 現在の年月を「YYYY年MM月」形式で表示
  - 「次の月へ」ボタンで1ヶ月進める（12月→翌年1月の年跨ぎ対応）
- 都市ステータスバー（画面上部）
  - 人口：「人口 50,000人」形式で表示
  - 財政：「財政 100,000,000円」形式で表示
  - 支持率：「支持率 60%」形式で表示
  - 初期値：人口50,000人、財政100,000,000円、支持率60%

### 予算配分システム（Budget Allocation）
- メインゲーム画面に「Budget」ボタンを追加
- フルスクリーンモーダルで予算配分UIを表示
  - 総予算と残額の表示（千区切りフォーマット）
  - 6カテゴリのスライダー操作（福祉・医療、教育・子育て、産業振興、インフラ整備、防災・安全、観光・文化）
  - 各カテゴリの金額（円）とパーセンテージをリアルタイム更新
  - 合計が総予算を超過した場合、残額を赤字で警告表示
  - 合計が総予算と一致する場合のみ「Confirm」ボタンが有効
- 確認ボタンで配分を保存しモーダルを閉じる
- 閉じるボタンで変更を破棄しモーダルを閉じる
- 再度開いた際は最後に確認した配分を表示
- Phase 1制限：配分は都市指標に影響しない（静的）

### 実装コンポーネント

#### TitleScreen
- `SaveDataChecker` - セーブデータ存在確認
- `TitleMenuController` - メニュー状態管理・イベント発火
- `TitleSceneTransition` - 画面遷移制御（MainGameScene への遷移）
- `UnitySceneTransitioner` - Unity SceneManagerのラッパー（入力検証付き）
- `TitleSceneInitializer` - タイトル画面の初期化と各コンポーネントの統合

#### MainGame
- `GameDate` - ゲーム内年月を表現するイミュータブルな値オブジェクト
- `GameState` - ゲーム全体の状態を保持するイミュータブルなオブジェクト（人口・財政・支持率・予算配分を含む）
- `BudgetAllocation` - 6カテゴリの予算配分を表現するイミュータブルな値オブジェクト
- `BudgetValidator` - 予算配分のバリデーション（合計と残額の計算）
- `TurnManager` - ターン進行ロジック（純粋C#クラス、都市指標を保持しながら月を進める）
- `GameStatePresenter` - ゲーム状態のUI反映（MonoBehaviour、日付と3つの都市指標ラベルを更新、予算配分の更新）
- `BudgetAllocationPresenter` - 予算配分UI管理（MonoBehaviour、スライダー・ラベル・バリデーション・イベント）
- `MainGameSceneInitializer` - メインゲーム画面の実行時UI生成と初期化（SafeAreaLayout適用済み、ステータスバーパネル・予算ボタン・予算画面を含む）
- `MainGameSceneSetup` - メインゲーム画面のエディタ上でのUIセットアップユーティリティ

#### UI共通
- `SafeAreaLayout` - デバイスのセーフエリアに合わせてRectTransformを自動調整（ノッチ・ダイナミックアイランド対応）
- `IScreenProvider` - スクリーン情報取得の抽象化インターフェース
- `UnityScreenProvider` - Screen APIをラップした本番用実装
